# Problem: Undo Behavior in AI vs Human Mode

## Original Issue
if i want to undo my previous operation in the ai vs human mode, i need to press U 2 times since single pressing on U only makes the board state to get back to the state where ai is going to make his own movement. what i want is when i press the U only 1 time in the my turn of ai vs human, the board state will get back to the one where i haven't make my movement in the my previous operation.

## Status: SOLVED 

## Solution Implemented
The undo behavior has been fixed to allow a single 'U' press to undo both the AI's move and the human's previous move when it's the human's turn in AI vs Human mode.

### Changes Made:

1. **GraphicalController.cpp** (`handleKeyPress()` method):
   - Added logic to detect when in AI vs Human mode (`HUMAN_VS_AI_HUMAN_WHITE` or `HUMAN_VS_AI_HUMAN_BLACK`)
   - When 'U' is pressed during human's turn, automatically undoes both:
     - The AI's last move (most recent move)
     - The human's previous move (second most recent move)
   - When 'U' is pressed during AI's turn, behaves normally (single undo)
   - In other game modes (Human vs Human, AI vs AI), maintains normal single undo behavior

2. **MenuController.cpp** (`makePlayerMove()` method):
   - Added identical logic for text mode undo command ('undo' or 'u')
   - Provides clear feedback messages for each undo operation
   - Maintains consistency with graphical interface behavior

### Technical Details:
- **Detection Logic**: Checks `currentGameMode` to determine if in AI vs Human mode
- **Human Turn Detection**: Compares `gameState->getCurrentPlayer()` with human color based on game mode
- **Double Undo**: When conditions met, calls `gameState->undoLastMove()` twice (with safety checks)
- **Edge Cases Handled**:
  - First move by AI (human hasn't moved yet) - only undoes AI move
  - Only one move in history - safely handles single undo
  - Game over state - undo still works to revert to previous states

### Testing:
-  All 30 unit tests pass
-  Manual testing confirms correct behavior in both graphical and text interfaces
-  Test cases for both human as Black (moves first) and human as White (moves second)
-  Edge cases properly handled

### Files Modified:
- `src/ui/GraphicalController.cpp` - Updated `handleKeyPress()` method
- `src/ui/MenuController.cpp` - Updated undo handling in `makePlayerMove()` method

### Result:
Users can now press 'U' once during their turn in AI vs Human mode to revert to the state before their previous move, effectively undoing both the AI's response and their own previous move with a single key press.
